<!DOCTYPE html>
<html>
    <head>
  <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="http://localhost:4000/js/com.alybadawy.external_links.js"></script>


    <title>python file download – Even Though ... 그럼에도 불구하고 열심히 – 작은 끄적거림</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="내가 이글을 적는 이유는 웹사이트에 있는 특정 정보를 추출하기 위해 스크레이핑(Scraping)을 하기 위해서이다.

" />
    <meta property="og:description" content="내가 이글을 적는 이유는 웹사이트에 있는 특정 정보를 추출하기 위해 스크레이핑(Scraping)을 하기 위해서이다.

" />
    
    <meta name="author" content="Even Though ... 그럼에도 불구하고 열심히" />

    
    <meta property="og:title" content="python file download" />
    <meta property="twitter:title" content="python file download" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Even Though ... 그럼에도 불구하고 열심히 - 작은 끄적거림" href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
  </head>
  
	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-55180057-2', 'auto');
		ga('send', 'pageview', {
		  'page': '/python-download/',
		  'title': 'python file download'
		});
	</script>
	<!-- End Google Analytics -->


  <body>
      <nav class="navbar navbar-pithy" role="navigation">
    <div class="container">
        <div class="collapse navbar-collapse" id="pithy-navbar">
                    <a href="/">home</a>
                    <a href="/about/">about</a>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
    </nav>
    
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="/images/xmlangel.jpg" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">Even Though ... 그럼에도 불구하고 열심히</a></h1>
            <p class="site-description">작은 끄적거림</p>
          </div>
        </header>
      </div>
    </div>
    <div id="s_left">
<div style="border:1px dashed; padding:5px;" ><h3>Tags</h3>
<ul class="tag-cloud">

  <span style="font-size: 83%">
    <a href="/tags/#docker">
      docker
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#debian">
      debian
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#dpkg">
      dpkg
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#SoapUI">
      SoapUI
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 83%">
    <a href="/tags/#Jmeter">
      Jmeter
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#GPG">
      GPG
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#linux">
      linux
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#command">
      command
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 79%">
    <a href="/tags/#Ubuntu">
      Ubuntu
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#Network">
      Network
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 79%">
    <a href="/tags/#IP">
      IP
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#route">
      route
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#chef">
      chef
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#python">
      python
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#download">
      download
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#urllib">
      urllib
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#PyDev">
      PyDev
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#virtualenv">
      virtualenv
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#Python">
      Python
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#vscode">
      vscode
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#kuberenetes">
      kuberenetes
    </a> &nbsp;&nbsp;
  </span>

  <span style="font-size: 74%">
    <a href="/tags/#K8s">
      K8s
    </a> &nbsp;&nbsp;
  </span>

</ul></div>
<p>
<div style="border:1px dashed; padding:5px;"><h3>Recent</h3>

  <article class="featured-list">
    <header class="featured-header">
      <a href="/install-kuberenetes/">Centos 에서 Kuberenetes 설치하기</a>
    </header>
    <div class="featured-post">
      * 목차{:toc}centos 에 설치하기 위해서는 master node 와 mini...
    </div>
    <footer>
      <a href="/install-kuberenetes/" class="button">Read more...</a>
    </footer>
  </article>

  <article class="featured-list">
    <header class="featured-header">
      <a href="/vscode/">sublim 에서 vs code 로 </a>
    </header>
    <div class="featured-post">
      Sublime  에서 vs code 로 넘어왔다.* 목차{:toc}# vscode 터...
    </div>
    <footer>
      <a href="/vscode/" class="button">Read more...</a>
    </footer>
  </article>

  <article class="featured-list">
    <header class="featured-header">
      <a href="/pydev-setup/">virtualenv로 Pydev 와 Django 설정 하기</a>
    </header>
    <div class="featured-post">
      Eclipes 플러그인인 PyDev 를 이용한 Django 설정을 하는 법입니다.* ...
    </div>
    <footer>
      <a href="/pydev-setup/" class="button">Read more...</a>
    </footer>
  </article>
</div>
</div>
<div id="main" role="main" class="container" ><article class="post">
  <h1>python file download</h1>

  <div class="entry">
    <p>내가 이글을 적는 이유는 웹사이트에 있는 특정 정보를 추출하기 위해 스크레이핑(Scraping)을 하기 위해서이다.</p>

<p>가장먼저 python 을 이용해서 다운로드 하는 부분을 알아보고 있다.</p>

<p>urllib.request 를 통해서 다운로드먼져..</p>

<ul id="markdown-toc">
  <li><a href="#다운로드-하기" id="markdown-toc-다운로드-하기">다운로드 하기</a>    <ul>
      <li><a href="#urllibrequest" id="markdown-toc-urllibrequest">urllib.request</a>        <ul>
          <li><a href="#파일로-저장urlretrieve" id="markdown-toc-파일로-저장urlretrieve">파일로 저장:urlretrieve()</a></li>
          <li><a href="#메모리로-저장--urlopen" id="markdown-toc-메모리로-저장--urlopen">메모리로 저장 : urlopen()</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#스크레이핑-하기scraping--하기" id="markdown-toc-스크레이핑-하기scraping--하기">스크레이핑 하기(Scraping)  하기</a>    <ul>
      <li><a href="#beautifulsoup" id="markdown-toc-beautifulsoup">BeautifulSoup</a>        <ul>
          <li><a href="#find" id="markdown-toc-find">find()</a></li>
          <li><a href="#find_all" id="markdown-toc-find_all">find_all()</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#사용예시" id="markdown-toc-사용예시">사용예시</a></li>
</ul>

<h1 id="다운로드-하기">다운로드 하기</h1>

<h2 id="urllibrequest">urllib.request</h2>

<h3 id="파일로-저장urlretrieve">파일로 저장:urlretrieve()</h3>
<p>urlretrieve()  함수를 이용해서 파일을 직접 다운로드 할 수 있다.</p>

<p>웹상에 있는 jpg 파일을 download.jpg 로 저장하는 예</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">urllib.request</span>

<span class="c"># URL 저장 경로 지정하기</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://xmlangel.github.io/images/xmlangel.jpg"</span>

<span class="c"># 저장할 파일이름</span>
<span class="n">savename</span> <span class="o">=</span> <span class="s">"download.jpg"</span>

<span class="c"># 다운로드</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">savename</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"저장완료"</span><span class="p">)</span></code></pre></figure>

<h3 id="메모리로-저장--urlopen">메모리로 저장 : urlopen()</h3>
<p>urlopen() 함수를 이용해서 메모리에 저장할 수 있다.</p>

<p>웹상에 있는 jpg 파일을 메모리에 로드후 download2.jpg 로 저장하는 예</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">urllib.request</span>

<span class="c"># URL 저장 경로 지정하기</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://xmlangel.github.io/images/xmlangel.jpg"</span>

<span class="c"># 저장할 파일이름</span>
<span class="n">savename</span> <span class="o">=</span> <span class="s">"download2.jpg"</span>

<span class="c">##다운로드</span>
<span class="n">memory</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">"memory 에 저장"</span><span class="p">)</span>

<span class="c">#파일로 저장</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">savename</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span><span class="s">"wb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">memory</span><span class="p">)</span>
	<span class="k">print</span><span class="p">(</span><span class="s">"저장완료"</span><span class="p">)</span></code></pre></figure>

<h1 id="스크레이핑-하기scraping--하기">스크레이핑 하기(Scraping)  하기</h1>
<h2 id="beautifulsoup">BeautifulSoup</h2>
<p>BeautifulSoup 은 HTML 과 XML 을 분석해주는 라이브러리 이다.</p>

<p>자세한 설명은 아래에서
https://www.crummy.com/software/BeautifulSoup/</p>

<p>pip를 이용해서 간단히 설치가 가능하다.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">pip install beautifulsoup4</code></pre></figure>

<h3 id="find">find()</h3>
<p>요소추출</p>

<h3 id="find_all">find_all()</h3>
<p>여러요소추출</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="n">html_doc</span> <span class="o">=</span> <span class="s">"""
&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;p class="title"&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;

&lt;p class="story"&gt;Once upon a time there were three little sisters; and their names were
&lt;a href="http://example.com/elsie" class="sister" id="link1"&gt;Elsie&lt;/a&gt;,
&lt;a href="http://example.com/lacie" class="sister" id="link2"&gt;Lacie&lt;/a&gt; and
&lt;a href="http://example.com/tillie" class="sister" id="link3"&gt;Tillie&lt;/a&gt;;
and they lived at the bottom of a well.&lt;/p&gt;

&lt;p class="story"&gt;...&lt;/p&gt;
"""</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html_doc</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>
<span class="c">#기본</span>
<span class="n">title1</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">title</span>
<span class="k">print</span><span class="p">(</span><span class="n">title1</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>

<span class="c"># 1개요소</span>
<span class="n">title</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">"title"</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">title</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>

<span class="c"># 여러개</span>
<span class="n">links</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">"a"</span><span class="p">)</span>

<span class="c"># 링크목록</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>
	<span class="n">heaf</span> <span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">'href'</span><span class="p">]</span>
	<span class="n">text</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">string</span>
	<span class="k">print</span><span class="p">(</span><span class="n">heaf</span><span class="p">,</span><span class="s">":"</span><span class="p">,</span><span class="n">text</span><span class="p">)</span></code></pre></figure>

<p>결과
&lt;</p>
<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">root</span><span class="nd">@python</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="c"># python beautifulsoup-find.py</span>
<span class="n">The</span> <span class="n">Dormouse</span><span class="s">'s story</span><span class="err">
</span><span class="s">The Dormouse'</span><span class="n">s</span> <span class="n">story</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">elsie</span> <span class="p">:</span> <span class="n">Elsie</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">lacie</span> <span class="p">:</span> <span class="n">Lacie</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">tillie</span> <span class="p">:</span> <span class="n">Tillie</span></code></pre></figure>

<h1 id="사용예시">사용예시</h1>
<p><span style="color:blue">
기상청에 있는 RSS 데이터를 이용해서 지역의 예보데이터를 가져오는 예제를 만들어 보겠다.
편의를 위해 지역명을 입력받는 형식으로 만든다.</span></p>

<p>기상청의 RSS 사이트는 아래 경로에서 확인 가능하다.</p>

<p>홈 &gt; 날씨 &gt; 생활과 산업 &gt; 서비스 &gt; 인터넷 &gt; 웹</p>

<p>URL 은 아래와 같다.
http://www.kma.go.kr/weather/lifenindustry/sevice_rss.jsp</p>

<p><a href="http://www.kma.go.kr/weather/forecast/mid-term-rss3.jsp?stnId=133">충청남도</a></p>

<p><a href="http://www.kma.go.kr/weather/forecast/mid-term-rss3.jsp?stnId=109">서울</a></p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">root@python:/home# pip install beautifulsoup4
Collecting beautifulsoup4
Installing collected packages: beautifulsoup4
Successfully installed beautifulsoup4-4.6.0</code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">urllib.parse</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="c"># 지역명을 입력받는다.(지역명이 없을경우 Error 를 보여준다.)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span> <span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="s">"Error: 지역이름을 입력하세요"</span><span class="p">)</span>
	<span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>
<span class="n">regionNumber</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c">#RSS Site 주소</span>
<span class="n">siteURL</span> <span class="o">=</span> <span class="s">"http://www.kma.go.kr/weather/forecast/mid-term-rss3.jsp"</span>

<span class="c"># 지역명이름을 위한 변수</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">{</span>
	<span class="s">'stnId'</span><span class="p">:</span> <span class="n">regionNumber</span>
<span class="p">}</span>
<span class="k">print</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

<span class="c"># 매개변수를 URL 인코딩을 해준다.</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

<span class="c"># RSS URL을 파라미터와 조합</span>
<span class="n">RSSurl</span> <span class="o">=</span> <span class="n">siteURL</span> <span class="o">+</span> <span class="s">"?"</span> <span class="o">+</span> <span class="n">params</span>

<span class="k">print</span><span class="p">(</span><span class="s">"url="</span><span class="p">,</span><span class="n">RSSurl</span><span class="p">)</span>

<span class="c">#RSS 정보를 메모리에 저장</span>
<span class="n">sitedata</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">RSSurl</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="c"># utf-8 형식으로 decode</span>
<span class="n">RSStext</span> <span class="o">=</span> <span class="n">sitedata</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">)</span>

<span class="c"># BeautifulSoup 으로 분석</span>
<span class="n">soup</span><span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">RSStext</span><span class="p">,</span><span class="s">"html.parser"</span><span class="p">)</span>

<span class="c">#정보추출</span>
<span class="n">title_list</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">"title"</span><span class="p">)</span>
<span class="n">wf</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">"wf"</span><span class="p">)</span>

<span class="k">for</span> <span class="n">title</span> <span class="ow">in</span> <span class="n">title_list</span><span class="p">:</span>
	<span class="n">sitetitle</span><span class="o">=</span><span class="n">title</span><span class="o">.</span><span class="n">string</span>
	<span class="k">print</span><span class="p">(</span><span class="n">sitetitle</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span></code></pre></figure>


  </div>
  <img src="/images/tag.png" alt="Tags: " class="tag-img"/><div class="post-tags">
  
  
  <a href="/tags/#python">python</a>,
  
  <a href="/tags/#download">download</a>,
  
  <a href="/tags/#urllib">urllib</a>
  
</div>
<br/>

  <div class="date">
    Written on August  5, 2017
  </div>
  <div class="comments">
	  
<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">

	    var disqus_shortname = 'xmlangel-github-io';

	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();

	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

  </div>
</article>
</div>
    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          
<a href="mailto:kwangmyung.kim@gmail.com"><i class="svg-icon email"></i></a>


<a href="https://github.com/xmlangel"><i class="svg-icon github"></i></a>








        </footer>
      </div>
</div>
  </body>
</html>
